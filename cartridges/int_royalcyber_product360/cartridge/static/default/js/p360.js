!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){var n,i;n=jQuery,i=function(e,t){var i,o,a,s=n(e),r={imageDir:"images",imageCount:0,zoomPower:t.p360Preferences.P360ZoomPower,zoomRadius:t.p360Preferences.P360ZoomRadius,autoRotate:t.p360Preferences.P360AutoRotate,autoRotateInterval:t.autoRotateInterval,canvasWidth:0,canvasHeight:0,canvasID:""},c=1,u=1,l=!1,h=!1,d=[],f=0,m=0,g=0,v=0,p=0,w=0,b=!1;t=n.extend(r,t);var I=function(){o.clearRect(0,0,o.canvas.width,o.canvas.height)},C=function(){n(".drag-to-spin").fadeOut(2e3)},z=function(){for(var e=0;e<=t.imageCount-1;e++)d[e]=new Image,t.p360Images[e]&&(0===t.p360Images[e].indexOf("http://")||0===t.p360Images[e].indexOf("https://")?d[e].src=t.p360Images[e]:d[e].src=t.imageDir+"/"+t.p360Images[e]),I(),d[e].onload=function(){o.font="10pt Calibri"}},x=function(){I();var e=this.newWidth,n=this.newHeight,i=new Image;i.onload=function(){o.drawImage(i,0,0,e,n)},0===t.p360Images[0].indexOf("http://")||0===t.p360Images[0].indexOf("https://")?i.src=t.p360Images[0]:i.src=t.imageDir+"/"+t.p360Images[0]},P=function(){var e=t.imageWidth,i=t.imageHeight,o={width:n("#"+t.canvasID).width(),height:n("#"+t.canvasID).height()},a=e/i,r={left:0,top:0,width:0,height:0};b?(s.find("#"+t.canvasID).css("width","700px"),r.height=o.width/a,r.width=o.width,r.left=-(r.width-o.width)/2,r.height>o.height&&(r.height=o.height,r.width=o.height*a)):(r.height=o.width/a,r.width=o.width,r.left=-(r.width-o.width)/2,r.height>o.height&&(r.height=o.height,r.width=o.height*a)),this.newHeight=r.height,this.newWidth=r.width},y=function(e){I(),o.drawImage(d[e],0,0,this.newWidth,this.newHeight)},R=function(){t.autoRotate=!0,n(".autospin").addClass("active"),m=setInterval((function(){g>0&&g<=t.imageCount-1&&f<=0&&(f=g),++f>t.imageCount-1&&(f=1),y(f)}),t.autoRotateInterval)};function D(){t.autoRotate=!1,clearInterval(m)}n(window).on("resize",(function(){P()})),s.append("<canvas id='"+t.canvasID+"' width='"+t.canvasWidth+"' height='"+t.canvasHeight+"'></canvas>").css({cursor:"e-resize"}),s.css({width:t.canvasWidth+"px",height:t.canvasHeight+"px",position:"relative"}),i=document.getElementById(t.canvasID),o=i.getContext("2d"),a=i.width/t.imageCount,I(),P(),z(),x(),!0===t.autoRotate&&d.length>1&&R(),n(document).on("click",".fullscreenbtn",(function(){var e=document.getElementById("p360");e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),setTimeout((function(){n("#fscreen").removeClass("fullscreenbtn").addClass("minimizeScreen"),s.addClass("fullscreen360"),b=!0,P(),z(),x()}),500)})),n("#fscreen").click((function(){n("#p360canvas").addClass("fullscreen")})),n(document).on("click",".minimizeScreen",(function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),setTimeout((function(){n("#fscreen").removeClass("minimizeScreen").addClass("fullscreenbtn"),s.removeClass("fullscreen360"),b=!1,s.find("#"+t.canvasID).removeAttr("style"),P(),z(),x()}),500)})),s.find("canvas").mousemove((function(e){var s=n(i).offset();C(),c=Math.floor(e.pageX-s.left),u=Math.floor(e.pageY-s.top),(g=Math.ceil(c/a)-p)<=-1?g=t.imageCount-1:g>t.imageCount-1&&(g=0),!0===l&&y(g),!0===h&&function(e){I(),h&&(o.drawImage(e,(0-c)*(t.zoomPower-1),(0-u)*(t.zoomPower-1),this.newWidth*t.zoomPower,this.newHeight*t.zoomPower),o.globalCompositeOperation="destination-atop",o.beginPath(),o.arc(c,u,t.zoomRadius,0,2*Math.PI,!0),o.closePath(),o.fill()),o.drawImage(e,0,0,this.newWidth,this.newHeight)}(d[v])})),s.find(".rotate-right").click((function(e){e.preventDefault(),C(),++g>t.imageCount-1&&(g=0),y(g)})),s.find(".rotate-left").click((function(e){e.preventDefault(),C(),--g<=-1&&(g=t.imageCount-1),y(g)})),s.find("#"+t.canvasID).mousedown((function(){C(),n("body").attr("unselectable","on").css("user-select","none").on("selectstart dragstart",!1),p=0===p?Math.ceil(c/a):Math.ceil(c/a)-w,l=!0})),n(document).mouseup((function(){n("body").removeAttr("unselectable").removeAttr("style"),w=g,l=!1})),s.find("#tb360Zoom").click((function(e){if(C(),n(this).hasClass("zoomin_button")){h=!0,n(this).addClass("zoomout_button"),n(this).removeClass("zoomin_button"),!0===t.autoRotate&&D();var o=n(i).offset();c=Math.floor(e.pageX-o.left),u=Math.floor(e.pageY-o.top),(v=Math.ceil(c/a))<=0?v=1:v>t.imageCount&&(v=t.imageCount),n("canvas").css({cursor:"zoom-in"}),n(this).css({cursor:"zoom-out"})}else v=0,h=!1,n(this).addClass("zoomin_button"),n(this).removeClass("zoomout_button"),n(this).css({cursor:"e-resize"}),s.find("#"+t.canvasID).trigger("mousedown"),s.find("#"+t.canvasID).trigger("mouseup"),n("canvas").css({cursor:"e-resize"}),n(this).css({cursor:"zoom-in"})})),s.find(".autospin").click((function(e){e.preventDefault(),C(),!1===t.autoRotate?(R(),n(this).addClass("active")):(D(),n(this).removeClass("active"))}))},n.fn.p360=function(e){return this.each((function(){var t=n(this);if(!t.data("p360")){var o=new i(this,e);t.data("p360",o)}}))}}]);